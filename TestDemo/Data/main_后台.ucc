<?xml version="1.0" encoding="gb2312"?>
<Solution ID="" Title="" about="" version="" DataPath=""><Project ID="Project" Title="尚嘉中心智能导航后台管理系统GIS2017" about="DATA" version="1.0" DataPath="Data" MultipleInstance="True"><UI><Screens><Screen ID="Me" Title="Me" Memo="" Action="" Container="" LTWH="0,0,1280,830" ForeColor="0" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" DragMode="0" ShowType="Window" ZoomRate="100%"/></Screens><Menus/><Layers><Layer ID="登录" Title="登录" Memo="" Action="" Container="Me" LTWH="0,0,1280,800" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\背景.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="1" DragMode="1"/><Layer ID="主界面" Title="主界面" Memo="" Action="" Container="Me" LTWH="0,0,1280,800" ForeColor="0" BackColor="-2147483643" Image="后台界面图标\背景.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="1" DragMode="1"/><Layer ID="Panel_系统配置" Title="Panel_系统配置" Memo="" Action="" Container="Layer:主界面" LTWH="270,150,1020,800" ForeColor="0" BackColor="-2147483643" Image="后台界面图标\背景_1.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="1"/><Layer ID="Panel_用户管理" Title="Panel_用户管理" Memo="" Action="" Container="Layer:主界面" LTWH="270,150,1020,800" ForeColor="0" BackColor="-2147483643" Image="后台界面图标\背景_1.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="1"/><Layer ID="Panel_广告轮播图" Title="Panel_广告轮播图" Memo="" Action="" Container="Layer:主界面" LTWH="270,150,1020,800" ForeColor="0" BackColor="-2147483643" Image="后台界面图标\背景_1.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="1"/><Layer ID="Panel_欢迎界面" Title="Panel_欢迎界面" Memo="" Action="" Container="Layer:主界面" LTWH="270,120,1020,800" ForeColor="0" BackColor="-2147483643" Image="后台界面图标\背景_1.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="1"/><Layer ID="Layer设备楼层" Title="Layer设备楼层" Memo="" Action="--将指针图片移动到鼠标点击时的坐标;Set:txt设备坐标Left.Text=@[x];Set:txt设备坐标Top.Text=@[y];Calc:LayerPin设备.Left=@[x] - (@LayerPin设备.Width / 2);Calc:LayerPin设备.Top=@[y] - @LayerPin设备.Height;" Container="Layer:Panel_设备管理" LTWH="303,50,704,713" ForeColor="0" BackColor="-2147483643" Image="L1.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="2"/><Layer ID="LayerPin设备" Title="LayerPin设备" Memo="" Action="" Container="Layer:Layer设备楼层" LTWH="237.4667,433,69,70" ForeColor="0" BackColor="-2147483643" Image="楼层定位图标.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="2"/><Layer ID="Panel_设备管理" Title="Panel_设备管理" Memo="" Action="" Container="Layer:主界面" LTWH="270,0,1020,800" ForeColor="0" BackColor="0" Image="后台界面图标\背景_1.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="1"/><Layer ID="LayerL1" Title="LayerL1" Memo="" Action="" Container="Layer:Panel_导航管理" LTWH="310,50,724,753" ForeColor="0" BackColor="-2147483643" Image="L1.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="2"/><Layer ID="LayerL2" Title="LayerL2" Memo="" Action="RunAction:fun记录并标注鼠标位置;" Container="Layer:Panel_导航管理" LTWH="310,-703,724,753" ForeColor="0" BackColor="-2147483643" Image="L2.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="2"/><Layer ID="LayerL3" Title="LayerL3" Memo="" Action="RunAction:fun记录并标注鼠标位置;" Container="Layer:Panel_导航管理" LTWH="310,-1456,724,753" ForeColor="0" BackColor="-2147483643" Image="L3.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="2"/><Layer ID="LayerL4" Title="LayerL4" Memo="" Action="RunAction:fun记录并标注鼠标位置;" Container="Layer:Panel_导航管理" LTWH="310,-2209,724,753" ForeColor="0" BackColor="-2147483643" Image="L4.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="2"/><Layer ID="LayerLG1" Title="LayerLG1" Memo="" Action="RunAction:fun记录并标注鼠标位置;" Container="Layer:Panel_导航管理" LTWH="310,803,724,753" ForeColor="0" BackColor="-2147483643" Image="LG1.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="2"/><Layer ID="LayerLG2" Title="LayerLG2" Memo="" Action="RunAction:fun记录并标注鼠标位置;" Container="Layer:Panel_导航管理" LTWH="310,1556,724,753" ForeColor="0" BackColor="-2147483643" Image="LG2.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="2"/><Layer ID="LayerPin" Title="LayerPin" Memo="" Action="" Container="Layer:LayerL1" LTWH="402.5333,420,69,70" ForeColor="0" BackColor="-2147483643" Image="楼层定位图标.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="1" DragMode="2"/><Layer ID="LayerFoot" Title="LayerFoot" Memo="" Action="" Container="Layer:LayerL1" LTWH="0,0,20,19" ForeColor="0" BackColor="-2147483643" Image="路径轨迹点.bmp" Visible="False" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="2"/><Layer ID="Panel_导航管理" Title="Panel_导航管理" Memo="" Action="" Container="Layer:主界面" LTWH="270,0,1280,800" ForeColor="0" BackColor="-2147483643" Image="后台界面图标\背景_1.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="1"/><Layer ID="Layer坐标设置" Title="Layer坐标设置" Memo="" Action="" Container="Layer:Panel_导航管理" LTWH="0,270,310,470" ForeColor="0" BackColor="2171169" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="9" BorderStyle="0" DragMode="1"/></Layers><Buttons><Button ID="欢迎登录尚嘉后台" Title="欢迎登录尚嘉后台" Memo="" Action="" Container="Layer:登录" LTWH="675,95,200,50" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="18" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Lab_用户名" Title="用户名：" Memo="" Action="" Container="Layer:登录" LTWH="640,260,80,20" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="BG_登录" Title="" Memo="" Action="" Container="Layer:登录" LTWH="640,415,100,40" ForeColor="0" BackColor="-2147483643" Image="后台界面图标\按钮点击效果.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="True" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="20" HeightIndent="0"/><Button ID="BG_退出" Title="" Memo="" Action="" Container="Layer:登录" LTWH="810,415,100,40" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\按钮点击效果.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="True" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="20" HeightIndent="0"/><Button ID="Btn_登录" Title="登      录" Memo="" Action="get:var临时用户名='@TB_用户名';get:var临时密码='@TB_密码';Case:var临时用户名 == '' Then Calc:var检测是否登陆=@var检测是否登陆 +1;Case:var临时密码 == '' Then Calc:var检测是否登陆=@var检测是否登陆 +1;Case:var检测是否登陆 == 0 Then RunAction:fun_登录 Else MsgBox:var = 账号或密码为空,0,'错误提示';Set:var检测是否登陆=0;" Container="Layer:登录" LTWH="640,415,100,40" ForeColor="0" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Btn_退出" Title="退      出" Memo="" Action="" Container="Layer:登录" LTWH="810,415,100,40" ForeColor="0" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Lab_密码" Title="密   码：" Memo="" Action="" Container="Layer:登录" LTWH="640,330,80,20" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="BG_系统配置" Title="" Memo="" Action="" Container="Layer:主界面" LTWH="0,150,260,70" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\左栏目框.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="True" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="20" HeightIndent="0"/><Button ID="BG_用户管理" Title="" Memo="" Action="" Container="Layer:主界面" LTWH="0,220,260,70" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\左栏目框.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="True" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="20" HeightIndent="0"/><Button ID="BG_广告轮播图" Title="" Memo="" Action="" Container="Layer:主界面" LTWH="0,290,260,70" ForeColor="5739438" BackColor="-2147483643" Image="后台界面图标\左栏目框.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="20" ShowType="Image" BorderStyle="0" AutoSize="True" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="BG_导航管理" Title="" Memo="" Action="" Container="Layer:主界面" LTWH="0,430,260,70" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\左栏目框选中.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="True" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="20" HeightIndent="0"/><Button ID="系统配置" Title="系统配置" Memo="" Action="HideLayer:登录,主界面,Panel_系统配置,Panel_用户管理,Panel_广告轮播图,Panel_欢迎界面,Panel_设备管理,Panel_导航管理;ShowLayer:主界面,Panel_系统配置;Set:系统配置.Forecolor=16777215;Set:用户管理.Forecolor=5739440;Set:广告轮播图.Forecolor=5739440;Set:导航管理.Forecolor=5739440;Set:设备管理.Forecolor=5739440;Set:BG_系统配置.Picture='后台界面图标\左栏目框选中.bmp';Set:BG_用户管理.Picture='后台界面图标\左栏目框.bmp';Set:BG_广告轮播图.Picture='后台界面图标\左栏目框.bmp';Set:BG_导航管理.Picture='后台界面图标\左栏目框.bmp';Set:BG_设备管理.Picture='后台界面图标\左栏目框.bmp';RunAction:fun刷新当前时间;" Container="Layer:主界面" LTWH="0,150,260,70" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="18" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="用户管理" Title="用户管理" Memo="" Action="HideLayer:登录,主界面,Panel_系统配置,Panel_用户管理,Panel_广告轮播图,Panel_欢迎界面,Panel_设备管理,Panel_导航管理;ShowLayer:主界面,Panel_用户管理;Set:系统配置.Forecolor=5739440;Set:用户管理.Forecolor=16777215;Set:广告轮播图.Forecolor=5739440;Set:导航管理.Forecolor=5739440;Set:设备管理.Forecolor=5739440;Set:BG_系统配置.Picture='后台界面图标\左栏目框.bmp';Set:BG_用户管理.Picture='后台界面图标\左栏目框选中.bmp';Set:BG_广告轮播图.Picture='后台界面图标\左栏目框.bmp';Set:BG_导航管理.Picture='后台界面图标\左栏目框.bmp';Set:BG_设备管理.Picture='后台界面图标\左栏目框.bmp';setontop:删除管理员,Button32copy1;RunAction:fun刷新用户列表;" Container="Layer:主界面" LTWH="0,220,260,70" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="18" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="广告轮播图" Title="图片管理" Memo="" Action="HideLayer:登录,主界面,Panel_系统配置,Panel_用户管理,Panel_广告轮播图,Panel_欢迎界面,Panel_设备管理,Panel_导航管理;ShowLayer:主界面,Panel_广告轮播图;Set:系统配置.Forecolor=5739440;Set:用户管理.Forecolor=5739440;Set:广告轮播图.Forecolor=16777215;Set:导航管理.Forecolor=5739440;Set:设备管理.Forecolor=5739440;Set:BG_系统配置.Picture='后台界面图标\左栏目框.bmp';Set:BG_用户管理.Picture='后台界面图标\左栏目框.bmp';Set:BG_广告轮播图.Picture='后台界面图标\左栏目框选中.bmp';Set:BG_导航管理.Picture='后台界面图标\左栏目框.bmp';Set:BG_设备管理.Picture='后台界面图标\左栏目框.bmp';Set:预览图.Picture='';Set:TB_上传图片路径='';Set:CB_轮播图类型.ListIndex=0;RunAction:@btn刷新_轮播图.action;" Container="Layer:主界面" LTWH="3,290,260,70" ForeColor="5739438" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="18" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="导航管理" Title="导航管理" Memo="" Action="HideLayer:登录,主界面,Panel_系统配置,Panel_用户管理,Panel_广告轮播图,Panel_欢迎界面,Panel_设备管理,Panel_导航管理;ShowLayer:主界面,Panel_导航管理;ShowControl:btn设置出发层轨迹;HideButton:LabelStep3;Move:var=Layer坐标设置,'0-270-310-470',200;Set:系统配置.Forecolor=5739440;Set:用户管理.Forecolor=5739440;Set:广告轮播图.Forecolor=5739440;Set:导航管理.Forecolor=16777215;Set:设备管理.Forecolor=5739440;Set:BG_系统配置.Picture='后台界面图标\左栏目框.bmp';Set:BG_用户管理.Picture='后台界面图标\左栏目框.bmp';Set:BG_广告轮播图.Picture='后台界面图标\左栏目框.bmp';Set:BG_导航管理.Picture='后台界面图标\左栏目框选中.bmp';Set:BG_设备管理.Picture='后台界面图标\左栏目框.bmp';--从【基础数据库】加载【楼层列表】;DB:db楼层列表=Access,'尚嘉2017.mdb','',SQL SELECT 楼层名称,序号 FROM t1001楼层信息 Order By 序号;BindingDataTo:Combo出发楼层=db楼层列表,楼层名称;BindingDataTo:Combo终点楼层=db楼层列表,楼层名称;Set:var当前楼层='L1';GetFieldValue:var当前楼层序号=db楼层列表,楼层名称=@var当前楼层,序号;Set:Combo出发楼层='@var当前楼层';Set:Combo终点楼层='@var当前楼层';Set:Combo延时时间=1000;RunAction:'@Combo出发楼层.action';RunAction:'@Combo终点楼层.action';" Container="Layer:主界面" LTWH="0,430,260,70" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="18" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="欢迎信息_1" Title="欢迎信息_1" Memo="" Action="" Container="Layer:Panel_欢迎界面" LTWH="100,100,500,50" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="22" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="欢迎信息_2" Title="欢迎使用尚嘉后台管理系统" Memo="" Action="" Container="Layer:Panel_欢迎界面" LTWH="0,200,1000,50" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="26" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Lab_当前系统待机时间" Title="当前系统待机时间（秒）：" Memo="" Action="" Container="Layer:Panel_系统配置" LTWH="100,100,300,50" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="16" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="当前系统待机时间" Title="100" Memo="" Action="" Container="Layer:Panel_系统配置" LTWH="360,100,100,50" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="16" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Lab_当前轮播图间隔" Title="当前轮播图间隔（秒）：" Memo="" Action="" Container="Layer:Panel_系统配置" LTWH="460,100,300,50" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="16" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="当前轮播图间隔" Title="100" Memo="" Action="" Container="Layer:Panel_系统配置" LTWH="700,100,100,50" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="16" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="BG_刷新" Title="" Memo="" Action="" Container="Layer:Panel_系统配置" LTWH="840,105,80,40" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\左栏目框选中.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="True" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="20" HeightIndent="0"/><Button ID="Btn_刷新" Title="刷新" Memo="" Action="DB:db系统配置=Access,'尚嘉2017.mdb','',SQL SELECT * FROM t0003系统配置;GetFieldValue:当前系统待机时间=db系统配置,1,系统待机时间;GetFieldValue:当前轮播图间隔=db系统配置,1,轮播图间隔;" Container="Layer:Panel_系统配置" LTWH="840,105,80,40" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Lab_重置" Title="重置：" Memo="" Action="" Container="Layer:Panel_系统配置" LTWH="100,250,80,50" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="16" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button25" Title="当前系统待机时间（秒）：" Memo="" Action="" Container="Layer:Panel_系统配置" LTWH="200,300,300,50" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="16" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button26" Title="当前轮播图间隔（秒）：" Memo="" Action="" Container="Layer:Panel_系统配置" LTWH="200,360,300,50" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="16" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button27" Title="" Memo="" Action="" Container="Layer:Panel_系统配置" LTWH="800,430,120,40" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\左栏目框选中.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="True" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="20" HeightIndent="0"/><Button ID="Btn_重置" Title="确认重置" Memo="" Action="Case:TB_系统待机时间 == '' Then MsgBox:var=系统待机时间不能为空,0,tip Else Case:TB_轮播图间隔 == '' Then MsgBox:var= 轮播图时间不能为空,0,tip Else RunAction:fun修改系统时间;" Container="Layer:Panel_系统配置" LTWH="800,430,120,40" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button29" Title="管理员列表" Memo="" Action="" Container="Layer:Panel_用户管理" LTWH="160,50,120,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button30" Title="" Memo="" Action="" Container="Layer:Panel_用户管理" LTWH="400,100,80,40" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\左栏目框选中.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="True" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="20" HeightIndent="0"/><Button ID="Button31" Title="刷新" Memo="" Action="RunAction:fun刷新用户列表" Container="Layer:Panel_用户管理" LTWH="400,100,80,40" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button32" Title="" Memo="" Action="" Container="Layer:Panel_用户管理" LTWH="550,100,120,40" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\左栏目框选中.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="True" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="20" HeightIndent="0"/><Button ID="Button33" Title="增加管理员" Memo="" Action="Case:TB_临时用户名 == '' Then MsgBox:var = 用户名为空,1,'错误提示' Else Case:TB_临时密码 == '' Then MsgBox:var = 密码为空,1,'错误提示'  Else Case:TB_临时密码 == TB_临时确认密码 Then RunAction:fun_增加管理员判断 Else MsgBox:var = 密码输入不一致,1,'错误提示';" Container="Layer:Panel_用户管理" LTWH="550,100,120,40" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button34" Title="用户名：" Memo="" Action="" Container="Layer:Panel_用户管理" LTWH="400,200,120,20" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button35" Title="密码：" Memo="" Action="" Container="Layer:Panel_用户管理" LTWH="400,250,120,20" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button36" Title="确认密码：" Memo="" Action="" Container="Layer:Panel_用户管理" LTWH="400,300,120,20" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button44" Title="活动图片预览" Memo="" Action="" Container="Layer:Panel_广告轮播图" LTWH="400,250,120,20" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button45" Title="图片名称" Memo="" Action="" Container="Layer:Panel_广告轮播图" LTWH="400,140,120,20" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button46" Title="类型选择" Memo="" Action="" Container="Layer:Panel_广告轮播图" LTWH="50,70,120,20" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button47" Title="上传图片" Memo="" Action="" Container="Layer:Panel_广告轮播图" LTWH="400,190,120,20" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button48" Title="" Memo="" Action="" Container="Layer:Panel_广告轮播图" LTWH="850,182,80,40" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\左栏目框选中.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="True" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="20" HeightIndent="0"/><Button ID="Button49" Title="选图" Memo="" Action="FileBrowse:图片源文件位置=*.*;Set:TB_上传图片路径=@图片源文件位置;--获取图片名称;GetFileNameFromURI:txt文件名='@图片源文件位置';--获取图片保存后的位置;--Case:CB_轮播图类型 == '首页轮播' Then LinkString:Var图片数据库地址='\','首页','@txt文件名' Else LinkString:Var图片数据库地址='\','主题活动','@txt文件名';--Case:CB_轮播图类型 == '首页轮播' Then LinkString:var图片保存位置='\','DataPath\首页','@txt文件名' Else LinkString:var图片保存位置='\','DataPath\主题活动','@txt文件名';--LinkString:Var图片数据库地址='\','主题活动','@txt文件名';--LinkString:var图片保存位置='\','DataPath\主题活动','@txt文件名';--将图片显示出来;Set:预览图.Picture='@图片源文件位置';" Container="Layer:Panel_广告轮播图" LTWH="850,182,80,40" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="预览图" Title="" Memo="" Action="" Container="Layer:Panel_广告轮播图" LTWH="400,280,550,225" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="1" AutoSize="True" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="20" HeightIndent="0"/><Button ID="Button2c" Title="Step 1 选中设备查看位置" Memo="" Action="" Container="Layer:Panel_设备管理" LTWH="10,20,270,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Butt2copy1copy1" Title="设备IP:" Memo="" Action="" Container="Layer:Panel_设备管理" LTWH="30,511,60,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Butt2copy1copy1copy1" Title="设备编号:" Memo="" Action="" Container="Layer:Panel_设备管理" LTWH="30,549,127,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Butt2copy1copy1copy1copy1" Title="点击左图设置设备坐标：" Memo="" Action="" Container="Layer:Panel_设备管理" LTWH="30,635,250,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Butt2cop" Title="设备所在楼层：" Memo="" Action="" Container="Layer:Panel_设备管理" LTWH="30,593,128,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Butt" Title="Setp 2 请完善设备信息" Memo="" Action="" Container="Layer:Panel_设备管理" LTWH="12,458,250,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Butt2copy1copy1copy2" Title="Left:" Memo="" Action="" Container="Layer:Panel_设备管理" LTWH="30,678,105,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Butt2copy1" Title="Top:" Memo="" Action="" Container="Layer:Panel_设备管理" LTWH="180,675,56,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="设备管理" Title="设备管理" Memo="" Action="HideLayer:登录,主界面,Panel_系统配置,Panel_用户管理,Panel_广告轮播图,Panel_欢迎界面,Panel_设备管理,Panel_导航管理;ShowLayer:主界面,Panel_设备管理;Set:系统配置.Forecolor=5739440;Set:用户管理.Forecolor=5739440;Set:广告轮播图.Forecolor=5739440;Set:导航管理.Forecolor=5739440;Set:设备管理.Forecolor=16777215;Set:BG_系统配置.Picture='后台界面图标\左栏目框.bmp';Set:BG_用户管理.Picture='后台界面图标\左栏目框.bmp';Set:BG_广告轮播图.Picture='后台界面图标\左栏目框.bmp';Set:BG_导航管理.Picture='后台界面图标\左栏目框.bmp';Set:BG_设备管理.Picture='后台界面图标\左栏目框选中.bmp';--从【基础数据库】加载【设备列表】;DB:db设备列表=Access,'尚嘉2017.mdb','',SQL SELECT ID,设备编号,设备IP,设备所在楼层名称 as 所在楼层,设备坐标 FROM t0002设备 Order By 设备编号;BindingDataTo:Report设备列表=db设备列表;--从【基础数据库】加载【楼层列表】;DB:db楼层列表=Access,'尚嘉2017.mdb','',SQL SELECT 楼层名称,序号 FROM t1001楼层信息 Order By 序号;BindingDataTo:Combo设备楼层=db楼层列表,楼层名称;" Container="Layer:主界面" LTWH="0,360,260,70" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="18" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="BG_设备管理" Title="" Memo="" Action="" Container="Layer:主界面" LTWH="0,360,260,70" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\左栏目框.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="True" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="20" HeightIndent="0"/><Button ID="Button2" Title="Step 3 请选择目标店铺：" Memo="" Action="" Container="Layer:Panel_导航管理" LTWH="10,170,320,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button2copy1copy4" Title="Setp 1 请选择出发楼层：" Memo="" Action="" Container="Layer:Panel_导航管理" LTWH="10,30,220,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button2copy1copy1copy1" Title="Setp 2 请选择目标店铺所在楼层：" Memo="" Action="" Container="Layer:Panel_导航管理" LTWH="10,100,250,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button2copy2" Title="延时(毫秒)：" Memo="" Action="" Container="Layer:Layer坐标设置" LTWH="132,114,104,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button2copy1" Title="Step 4 目标店铺坐标：" Memo="" Action="" Container="Layer:Panel_导航管理" LTWH="10,240,320,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="删除管理员" Title="删除管理员" Memo="" Action="GetFieldValue:Var当前条目在数据库中的id=db用户,@当前条目id,ID;DB:db用户=Access,尚嘉2017.mdb,,SQL update t0001用户 set 是否删除='是' WHERE ID='@Var当前条目在数据库中的id';RunAction:fun刷新用户列表;" Container="Layer:Panel_用户管理" LTWH="730,100,120,40" ForeColor="16777215" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button32copy1" Title="" Memo="" Action="" Container="Layer:Panel_用户管理" LTWH="730,100,120,40" ForeColor="16777215" BackColor="-2147483643" Image="Button.Button32copy1.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="True" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="20" HeightIndent="0"/><Button ID="尺寸提示" Title="（注意：图片是1920 X 1080 哟~）" Memo="" Action="" Container="Layer:Panel_广告轮播图" LTWH="520,250,300,20" ForeColor="255" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="btn刷新_轮播图" Title="刷新" Memo="" Action="Set:var活动分类='@CB_轮播图类型.Text';Case:CB_轮播图类型 == '首页轮播' Then RunAction:fun_刷新首页轮播;Case:CB_轮播图类型 == '主题活动' Then RunAction:fun_刷新主题活动;Case:CB_轮播图类型 == '推广活动' Then RunAction:fun_刷新主题活动;Case:CB_轮播图类型 == '至尊会' Then RunAction:fun_刷新主题活动;Case:CB_轮播图类型 == '尚悦会' Then RunAction:fun_刷新主题活动;Case:CB_轮播图类型 == '' Then MsgBox:var = 请先选择轮播图类型,0,'tip';Set:当前条目id=1;" Container="Layer:Panel_广告轮播图" LTWH="286,61,80,40" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\按钮选中.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="btn刷新_增加" Title="增加" Memo="" Action="Case:CB_轮播图类型 == '首页轮播' Then LinkString:Var图片数据库地址='\','首页','@txt文件名' Else LinkString:Var图片数据库地址='\','主题活动','@txt文件名';Case:CB_轮播图类型 == '首页轮播' Then LinkString:var图片保存位置='\','DataPath\首页','@txt文件名' Else LinkString:var图片保存位置='\','DataPath\主题活动','@txt文件名';Case:TB_上传图片路径 == '' Then MsgBox:var = 请先选择上传图片,0,'tip' Else Case:CB_轮播图类型 == '' Then MsgBox:var = 请先选择轮播图类型,0,'tip' Else Case:TB_活动名称 == '' Then MsgBox:var = 请先输入活动名称,0,'tip' Else Case:CB_轮播图类型 == '首页轮播' Then RunAction:fun_增加首页轮播图 Else RunAction:fun_增加非首页轮播图;RunAction:@btn刷新_轮播图.Action;" Container="Layer:Panel_广告轮播图" LTWH="846,531,80,40" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\按钮选中.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="btn刷新_删除" Title="删除" Memo="" Action="Case:CB_轮播图类型 == '首页轮播' Then RunAction:fun_删除首页轮播图 Else RunAction:fun_删除非首页轮播图;RunAction:@btn刷新_轮播图.Action;" Container="Layer:Panel_广告轮播图" LTWH="286,531,80,40" ForeColor="16777215" BackColor="-2147483643" Image="后台界面图标\按钮选中.bmp" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Image" BorderStyle="0" AutoSize="False" TitleAlignment="5" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="Button2copy2copy1" Title="当前坐标：" Memo="" Action="" Container="Layer:Layer坐标设置" LTWH="132,235,104,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/><Button ID="LabelStep3" Title="Step 2 点击右侧地图设置出发层坐标：" Memo="" Action="" Container="Layer:Layer坐标设置" LTWH="10,0,320,20" ForeColor="5739440" BackColor="-2147483643" Image="" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Label" BorderStyle="0" AutoSize="False" TitleAlignment="4" ImageAlignment="4" TitleImageRelation="3" WidthIndent="0" HeightIndent="0"/></Buttons><Controls><Control ID="TB_用户名" Title="TB_用户名" Memo="" Action="" Container="Layer:登录" LTWH="740,255,170,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="TB_密码" Title="TB_密码" Memo="" Action="" Container="Layer:登录" LTWH="740,325,170,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="TB_系统待机时间" Title="系统待机时间" Memo="" Action="" Container="Layer:Panel_系统配置" LTWH="500,310,120,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="TB_轮播图间隔" Title="轮播图间隔" Memo="" Action="" Container="Layer:Panel_系统配置" LTWH="500,370,120,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="TB_临时用户名" Title="TextBox6" Memo="" Action="" Container="Layer:Panel_用户管理" LTWH="500,195,170,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="TB_临时密码" Title="TextBox7" Memo="" Action="" Container="Layer:Panel_用户管理" LTWH="500,245,170,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="TB_临时确认密码" Title="TextBox8" Memo="" Action="" Container="Layer:Panel_用户管理" LTWH="500,295,170,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="Report活动列表" Title="Report活动列表" Memo="" Action="GetSelectedIndex:当前条目id=this;GetFieldValue:预览图.Picture=db轮播图,@当前条目id,图片地址;GetFieldValue:Var当前条目在数据库中的id=db轮播图,@当前条目id,ID;" Container="Layer:Panel_广告轮播图" LTWH="50,130,320,375" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Report" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="CB_轮播图类型" Title="CB_轮播图类型" Memo="" Action="Case:CB_轮播图类型 == '首页轮播' Then Set:尺寸提示='（注意：图片是1920 X 1080 哟~）' Else Set:尺寸提示='（注意：图片是1372 X 560 哟~）';" Container="Layer:Panel_广告轮播图" LTWH="170,65,110,28" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="ComboBox" Value="主题活动,推广活动,至尊会,尚悦会,首页轮播" BorderStyle="1" TextAlignment="1"/><Control ID="TB_上传图片路径" Title="TB_上传图片路径" Memo="" Action="" Container="Layer:Panel_广告轮播图" LTWH="480,185,340,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="TB_活动名称" Title="TextBox10" Memo="" Action="" Container="Layer:Panel_广告轮播图" LTWH="480,135,250,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="List用户列表" Title="List用户列表" Memo="" Action="GetSelectedIndex:当前条目id=this;GetFieldValue:Var当前条目在数据库中的id=db用户,@当前条目id,ID;" Container="Layer:Panel_用户管理" LTWH="100,101,200,240" ForeColor="16777215" BackColor="3487029" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="ListBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn新增设备" Title="新增" Memo="" Action="Set:var聚合坐标='';--聚合行走轨迹;Calc:varCount=@List行走路线坐标.ListCount -1;For:i,0,@varCount=RunAction:fun聚合一个坐标;GetPartOfString:var聚合坐标='@var聚合坐标',2,RIGHT;GetSelectedIndex:Index=Report目标楼层店铺列表;GetFieldValue:var铺位编号=db店铺列表,@Index,铺位编号;GetFieldValue:var铺位号=db店铺列表,@Index,铺位号;" Container="Layer:Panel_设备管理" LTWH="19,390,110,50" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn修改设备信息" Title="修改" Memo="" Action="Set:var聚合坐标='';--聚合行走轨迹;Calc:varCount=@List行走路线坐标.ListCount -1;For:i,0,@varCount=RunAction:fun聚合一个坐标;GetPartOfString:var聚合坐标='@var聚合坐标',2,RIGHT;GetSelectedIndex:Index=Report目标楼层店铺列表;GetFieldValue:var铺位编号=db店铺列表,@Index,铺位编号;GetFieldValue:var铺位号=db店铺列表,@Index,铺位号;" Container="Layer:Panel_设备管理" LTWH="110,390,90,50" ForeColor="0" BackColor="16777215" Visible="False" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn删除设备" Title="删除" Memo="" Action="GetSelectedIndex:Index=Report设备列表;GetFieldValue:varID=db设备列表,@Index,ID;DB:db设备列表=Access,'尚嘉2017.mdb','',SQL DELETE FROM t0002设备  WHERE ID='@varID' ;MsgBox:var='设备坐标删除成功';--从【基础数据库】加载【设备列表】;DB:db设备列表=Access,'尚嘉2017.mdb','',SQL SELECT ID,设备编号,设备IP,设备所在楼层名称 as 所在楼层,设备坐标 FROM t0002设备 Order By 设备编号;BindingDataTo:Report设备列表=db设备列表;" Container="Layer:Panel_设备管理" LTWH="180,390,110,50" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="txt设备IP" Title="txt设备IP" Memo="" Action="" Container="Layer:Panel_设备管理" LTWH="120,506,170,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="192.168.1.123" BorderStyle="1" TextAlignment="1"/><Control ID="txt设备编号" Title="txt设备编号" Memo="" Action="" Container="Layer:Panel_设备管理" LTWH="120,544,170,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="L101" BorderStyle="1" TextAlignment="1"/><Control ID="btn保存设备信息" Title="保存" Memo="" Action="GetRandomNumber:varID=9999;LinkString:var设备坐标='-','@txt设备坐标Left.Text','@txt设备坐标Top.Text';DB:db设备列表=Access,'尚嘉2017.mdb','',SQL INSERT INTO t0002设备 (ID,设备编号,设备IP,设备所在楼层名称,设备坐标) values ('@varID', '@txt设备编号','@txt设备IP','@Combo设备楼层','@var设备坐标') ;MsgBox:var='设备坐标保存成功';--从【基础数据库】加载【设备列表】;DB:db设备列表=Access,'尚嘉2017.mdb','',SQL SELECT ID,设备编号,设备IP,设备所在楼层名称 as 所在楼层,设备坐标 FROM t0002设备 Order By 设备编号;BindingDataTo:Report设备列表=db设备列表;" Container="Layer:Panel_设备管理" LTWH="70,724,190,50" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="Combo设备楼层" Title="Combo设备楼层" Memo="" Action="--显示设备楼层图片;LinkString:var楼层图片='','@Combo设备楼层.Text','.bmp';Set:Layer设备楼层.Picture='@var楼层图片';" Container="Layer:Panel_设备管理" LTWH="158,587,132,28" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="ComboBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="Report设备列表" Title="Report设备列表" Memo="" Action="--显示选中的设备信息;GetSelectedIndex:Index=Report设备列表;GetFieldValue:txt设备IP.Text=db设备列表,@Index,设备IP;GetFieldValue:txt设备编号.Text=db设备列表,@Index,设备编号;GetFieldValue:Combo设备楼层.Text=db设备列表,@Index,所在楼层;GetFieldValue:var当前楼层设备坐标=db设备列表,@Index,设备坐标;GetPartOfString:txt设备坐标Left.Text=@var当前楼层设备坐标,'-',1;GetPartOfString:txt设备坐标Top.Text=@var当前楼层设备坐标,'-',2;--显示设备楼层图片;LinkString:var楼层图片='','@Combo设备楼层.Text','.bmp';Set:Layer设备楼层.Picture='@var楼层图片';--移动指针到该楼层的第一个设备坐标;Calc:varLeft=@txt设备坐标Left.Text - (@LayerPin设备.Width / 2);Calc:varTop=@txt设备坐标Top.Text - @LayerPin设备.Height;Move:var=LayerPin设备,'@varLeft-@varTop',To,100;--Move:var=LayerPin设备,'@varLeft-@varTop';" Container="Layer:Panel_设备管理" LTWH="10,50,290,320" ForeColor="33023" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Report" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="txt设备坐标Left" Title="txt设备坐标Left" Memo="" Action="" Container="Layer:Panel_设备管理" LTWH="93,671,70,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="txt设备坐标Top" Title="txt设备坐标Top" Memo="" Action="" Container="Layer:Panel_设备管理" LTWH="220,670,70,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="List行走路线坐标" Title="List行走路线坐标" Memo="" Action="Set:i=List行走路线坐标.ListIndex;Set:var单步测试 = '是';RunAction:fun走一步并画线;" Container="Layer:Layer坐标设置" LTWH="10,30,120,370" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="ListBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn删除选中轨迹" Title="删除选中轨迹" Memo="" Action="Set:i=List行走路线坐标.ListIndex;Remove:List行走路线坐标=@i;" Container="Layer:Layer坐标设置" LTWH="160,350,140,50" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn保存行走轨迹" Title="Step 6 保存行走轨迹" Memo="" Action="--导航编号,出发设备编号,目标铺位编号,行走轨迹;GetRandomNumber:varID=9999;DB:db设备列表=Access,'尚嘉2017.mdb','',SQL SELECT 设备所在楼层名称,设备编号 FROM t0002设备 WHERE 设备所在楼层名称='@Combo出发楼层';--注意：这里默认取该楼层的第一台设备，当有很多台时，需要让用户选择其中一台;GetFieldValue:var出发设备编号=db设备列表,1,设备编号;GetSelectedIndex:Index=Report目标楼层店铺列表;GetFieldValue:var铺位编号=db店铺列表,@Index,铺位编号;--聚合行走轨迹;Set:var聚合坐标='';Calc:varCount=@List行走路线坐标.ListCount -1;For:i,0,@varCount=RunAction:fun聚合一个坐标;GetPartOfString:var聚合坐标='@var聚合坐标',2,RIGHT;--查询出发层轨迹;DB:db设备列表=Access,'尚嘉2017.mdb','',SQL SELECT * FROM t0002设备 WHERE 设备所在楼层名称='@Combo出发楼层';Set:var出发层轨迹='';GetFieldValue:var出发层轨迹=db设备列表,1,出发层轨迹;--组合轨迹：出发楼层和终点楼层一致，则直接使用终点楼层;Case:'@Combo出发楼层.Text'=='@Combo终点楼层.Text' Then Set:var行走轨迹='@var聚合坐标' Else LinkString:var行走轨迹='/','@var出发层轨迹','@var聚合坐标';--更新到数据库;DB:db设备列表=Access,'尚嘉2017.mdb','',SQL DELETE FROM t3002铺位导航 WHERE 出发设备编号 ='@var出发设备编号' AND 目标铺位编号 = '@var铺位编号' ;DB:db设备列表=Access,'尚嘉2017.mdb','',SQL INSERT INTO t3002铺位导航 (导航编号,出发设备编号,目标铺位编号,行走轨迹,出发楼层,目标楼层轨迹) values ('@varID', '@var出发设备编号','@var铺位编号','@var行走轨迹','@Combo出发楼层','@var聚合坐标') ;MsgBox:var='从@Combo出发楼层 到 @Combo终点楼层 的店铺 @txt目标店铺 的导航轨迹保存成功';" Container="Layer:Panel_导航管理" LTWH="10,740,290,50" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="Combo出发楼层" Title="Combo出发楼层" Memo="" Action="--切换到新的出发楼层;Set:varStartIndex=var当前楼层序号;GetFieldValue:varFinishIndex=db楼层列表,楼层名称=@Combo出发楼层,序号;Set:var目标楼层='@Combo出发楼层';RunAction:fun执行滚动切换楼层指令;Set:var当前楼层='@Combo出发楼层';Set:var当前楼层序号='@varFinishIndex';--移动指针到该楼层的第一个设备坐标;DB:db设备列表=Access,'尚嘉2017.mdb','',SQL SELECT 设备所在楼层名称,设备坐标 FROM t0002设备 WHERE 设备所在楼层名称='@Combo出发楼层';GetFieldValue:var当前楼层设备坐标=db设备列表,1,设备坐标;GetPartOfString:varLeft=@var当前楼层设备坐标,'-',1;GetPartOfString:varTop=@var当前楼层设备坐标,'-',2;Calc:varLeft=@varLeft - (@LayerPin.Width / 2);Calc:varTop=@varTop - @LayerPin.Height;Move:var=LayerPin,'@varLeft-@varTop',To,200;--如果是出发层轨迹设置状态，则加载出发层轨迹;Case:'@var出发层设置状态' == '是' Then RunAction:fun加载出发层轨迹;" Container="Layer:Panel_导航管理" LTWH="10,60,120,28" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="ComboBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="Combo终点楼层" Title="Combo终点楼层" Memo="" Action="RunAction:fun查询目标楼层店铺轨迹;" Container="Layer:Panel_导航管理" LTWH="10,130,120,28" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="ComboBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn插入楼层切换指令" Title="插入楼层切换指令" Memo="" Action="--获得楼层序号;GetFieldValue:var目标楼层序号=db楼层列表,楼层名称=@Combo终点楼层,序号;Add:List行走路线坐标=S,'GO-@Combo终点楼层 (@var目标楼层序号)';--切换到目标楼层;Set:varStartIndex=var当前楼层序号;GetFieldValue:varFinishIndex=db楼层列表,楼层名称=@Combo终点楼层,序号;Set:var目标楼层='@Combo终点楼层';RunAction:fun执行滚动切换楼层指令;Set:var当前楼层='@Combo终点楼层';Set:var当前楼层序号='@varFinishIndex';" Container="Layer:Layer坐标设置" LTWH="160,30,140,50" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn插入延时指令" Title="插入延时指令" Memo="" Action="Add:List行走路线坐标=S,'DELAY-@Combo延时时间';" Container="Layer:Layer坐标设置" LTWH="160,150,140,50" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="Combo延时时间" Title="Combo延时时间" Memo="" Action="" Container="Layer:Layer坐标设置" LTWH="210,110,90,28" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="ComboBox" Value="500,800,1000,2000" BorderStyle="1" TextAlignment="1"/><Control ID="Report目标楼层店铺列表" Title="Report目标楼层店铺列表" Memo="" Action="GetSelectedIndex:Index=Report目标楼层店铺列表;GetFieldValue:var铺位编号=db店铺列表,@Index,铺位编号;GetFieldValue:var铺位号=db店铺列表,@Index,铺位号;GetFieldValue:var品牌中文名=db店铺列表,@Index,品牌中文名;LinkString:txt目标店铺.Text=' ','@var铺位号','@var品牌中文名';HideControl:Report目标楼层店铺列表;--如果找到行走路线数据，则加载;DB:db设备列表=Access,'尚嘉2017.mdb','',SQL SELECT 设备所在楼层名称,设备编号 FROM t0002设备 WHERE 设备所在楼层名称='@Combo出发楼层';GetFieldValue:var出发设备编号=db设备列表,1,设备编号;DB:db铺位导航列表=Access,'尚嘉2017.mdb','',SQL SELECT 出发设备编号,目标铺位编号,行走轨迹,目标楼层轨迹 FROM t3002铺位导航 WHERE 出发设备编号='@var出发设备编号' AND 目标铺位编号='@var铺位编号';Set:var聚合坐标='';GetFieldValue:var聚合坐标=db铺位导航列表,1,目标楼层轨迹;Clear:List行走路线坐标;GetPartOfString:List行走路线坐标='@var聚合坐标','/',Binding;" Container="Layer:Panel_导航管理" LTWH="10,240,292,550" ForeColor="33023" BackColor="16777215" Visible="False" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="Report" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn预览行走轨迹" Title="预览行走轨迹" Memo="" Action="--切换到新的出发楼层;Set:varStartIndex=var当前楼层序号;GetFieldValue:varFinishIndex=db楼层列表,楼层名称=@Combo出发楼层,序号;Set:var目标楼层='@Combo出发楼层';RunAction:fun执行滚动切换楼层指令;Set:var当前楼层='@Combo出发楼层';Set:var当前楼层序号='@varFinishIndex';Set:var单步测试 = '否';--把坐标移到默认位置;Move:var=LayerPin,'@var设备坐标','To';--播放行走轨迹;Clear:LayerL1,LayerL2,LayerL3,LayerL4,LayerLG1,LayerLG2;HideLayer:LayerPin;----绘制轨迹;Calc:varCount=@List行走路线坐标.ListCount -1;For:i,0,@varCount=RunAction:fun走一步并画线;--显示终点坐标;Calc:varLeft=@varLastLeft - (@LayerPin.Width / 2);Calc:varTop=@varLastTop - @LayerPin.Height;Move:var=LayerPin,'@varLeft-@varTop';ShowLayer:LayerPin;" Container="Layer:Layer坐标设置" LTWH="140,410,160,50" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn选择目标店铺" Title="..." Memo="" Action="ShowControl:Report目标楼层店铺列表;" Container="Layer:Panel_导航管理" LTWH="230,198,70,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="txt目标店铺" Title="txt目标店铺" Memo="" Action="" Container="Layer:Panel_导航管理" LTWH="8,198,220,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="txt当前坐标" Title="txt当前坐标" Memo="" Action="" Container="Layer:Layer坐标设置" LTWH="210,230,90,30" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="TextBox" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn设置出发层轨迹" Title="设置出发层轨迹" Memo="" Action="--调整 Layer坐标设置 的坐标;Move:var=Layer坐标设置,'0-100-310-700',200;--调整部分界面对象;ShowLayer:Layer坐标设置;HideControl:btn设置出发层轨迹,btn导入出发层轨迹,btn插入楼层切换指令;ShowButton:LabelStep3;--设置状态标识;Set:var出发层设置状态='是';--如果是出发层轨迹设置状态，则加载出发层轨迹;Case:'@var出发层设置状态' == '是' Then RunAction:fun加载出发层轨迹;" Container="Layer:Panel_导航管理" LTWH="140,55,160,40" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn保存出发层轨迹" Title="Step 3 保存出发层轨迹" Memo="" Action="--出发层轨迹;DB:db设备列表=Access,'尚嘉2017.mdb','',SQL SELECT * FROM t0002设备 WHERE 设备所在楼层名称='@Combo出发楼层';--注意：这里默认取该楼层的第一台设备，当有很多台时，需要让用户选择其中一台;GetFieldValue:varID=db设备列表,1,ID;--聚合行走轨迹;Set:var聚合坐标='';Calc:varCount=@List行走路线坐标.ListCount -1;For:i,0,@varCount=RunAction:fun聚合一个坐标;GetPartOfString:var聚合坐标='@var聚合坐标',2,RIGHT;--更新【t0002设备表】的 【出发层轨迹】字段;DB:db设备列表=Access,'尚嘉2017.mdb','',SQL UPDATE t0002设备 SET 出发层轨迹 ='@var聚合坐标' WHERE ID='@varID';MsgBox:var='楼层 @Combo出发楼层 的出发层轨迹 保存成功';" Container="Layer:Layer坐标设置" LTWH="10,480,290,50" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn取消设置出发层轨迹" Title="取消设置出发层轨迹" Memo="" Action="--调整 Layer坐标设置 的坐标;Move:var=Layer坐标设置,'0-270-310-470',200;--调整部分界面对象;ShowLayer:Layer坐标设置;ShowControl:btn设置出发层轨迹,btn导入出发层轨迹,btn插入楼层切换指令;HideButton:LabelStep3;HideControl:Report目标楼层店铺列表;--设置状态标识;Set:var出发层设置状态='否';--清空轨迹列表;Clear:List行走路线坐标;" Container="Layer:Layer坐标设置" LTWH="10,550,290,50" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn清除地图上的轨迹" Title="重置地图" Memo="" Action="Clear:LayerL1,LayerL2,LayerL3,LayerL4,LayerLG1,LayerLG2;" Container="Layer:Layer坐标设置" LTWH="10,410,120,50" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/><Control ID="btn插入轨迹坐标" Title="插入轨迹坐标" Memo="" Action="Set:i=List行走路线坐标.ListIndex;Calc:i=@i +1;Add:List行走路线坐标=S,'@txt当前坐标.Text',i;Set:List行走路线坐标.ListIndex=@i;" Container="Layer:Layer坐标设置" LTWH="160,270,140,50" ForeColor="0" BackColor="16777215" Visible="True" isLock="False" FontName="微软雅黑" FontSize="12" ShowType="CommandButton" Value="" BorderStyle="1" TextAlignment="1"/></Controls><Timers/></UI><Data><DataSources/><Vars><Var ID="var临时用户名" Memo="" Title="var临时用户名" Value="admin" Container="" DataType=""/><Var ID="var临时密码" Memo="" Title="var临时密码" Value="admin" Container="" DataType=""/><Var ID="var密码MD5" Memo="" Title="var密码MD5" Value="21232F297A57A5A743894A0E4A801FC3" Container="" DataType=""/><Var ID="db用户" Memo="" Title="db用户" Value="" Container="" DataType="DataSet"/><Var ID="var检测是否登陆" Memo="" Title="var检测是否登陆" Value="0" Container="" DataType=""/><Var ID="fun_登录" Memo="" Title="fun_登录" Value="Hash:var密码MD5=STRING,MD5,'@TB_密码';DB:db用户=Access,'尚嘉2017.mdb','',SQL select * from t0001用户 where 用户名='@var临时用户名' and 密码='@var密码MD5' and 是否删除='否';GetRecordCount:var检测是否登陆=db用户;Case:@var检测是否登陆 == 1 Then RunAction:fun_登陆成功 Else MsgBox:var = 账号或密码错误,0,'错误提示';" Container="" DataType=""/><Var ID="fun_登陆成功" Memo="" Title="fun_登陆成功" Value="HideLayer:登录,主界面,Panel_系统配置,Panel_用户管理,Panel_广告轮播图,Panel_欢迎界面,Panel_设备管理,Panel_导航管理;ShowLayer:主界面,Panel_欢迎界面;RunAction:fun_欢迎信息;Set:系统配置.Forecolor=5739440;Set:用户管理.Forecolor=5739440;Set:广告轮播图.Forecolor=5739440;Set:导航管理.Forecolor=5739440;Set:BG_系统配置.Picture='后台界面图标\左栏目框.bmp';Set:BG_用户管理.Picture='后台界面图标\左栏目框.bmp';Set:BG_广告轮播图.Picture='后台界面图标\左栏目框.bmp';Set:BG_导航管理.Picture='后台界面图标\左栏目框.bmp';" Container="" DataType=""/><Var ID="[main]" Memo="" Title="[main]" Value="Set:var检测是否登陆=0;SetOnTop:Btn_登录,BG_登录;HideLayer:登录,主界面;ShowLayer:登录;ShowButton:设备管理;Set:TB_密码.PasswordChar ='*';Set:TB_临时密码.PasswordChar ='*';Set:TB_临时确认密码.PasswordChar ='*';Set:预览图.Picture='';Set:List用户列表.ItemHeight=40;--将箭头透明化;Transparent:LayerPin;Transparent:LayerPin设备;Transparent:LayerFoot;--按顺序排列楼层平面图;Set:LayerL1.Left=310;Set:LayerL2.Left=310;Set:LayerL3.Left=310;Set:LayerL4.Left=310;Set:LayerLG1.Left=310;Set:LayerLG2.Left=310;Set:LayerL1.Top=50;Calc:LayerLG1.Top=@LayerL1.Top + @LayerL1.Height;Calc:LayerLG2.Top=@LayerLG1.Top + @LayerLG1.Height;Calc:LayerL2.Top=@LayerL1.Top - @LayerL2.Height;Calc:LayerL3.Top=@LayerL2.Top - @LayerL3.Height;Calc:LayerL4.Top=@LayerL3.Top - @LayerL4.Height;" Container="" DataType=""/><Var ID="Var系统当前时间" Memo="" Title="Var系统当前时间" Value="2017-06-07 11:21:26" Container="" DataType=""/><Var ID="fun_欢迎信息" Memo="" Title="fun_欢迎信息" Value="GetDateTime:Var小时部分=HOUR;Case:Var小时部分 &lt; 6 Then Set:Var欢迎信息='，晚上好！';Case:Var小时部分 &gt; 19 Then Set:Var欢迎信息='，晚上好！';Case:Var小时部分 &gt;= 6 Then Case:Var小时部分 &lt; 12 Then Set:Var欢迎信息='，上午好！';Case:Var小时部分 &gt;= 12 Then Case:Var小时部分 &lt; 13 Then Set:Var欢迎信息='，中午好！';Case:Var小时部分 &gt;= 13 Then Case:Var小时部分 &lt; 19 Then Set:Var欢迎信息='，下午好！';LinkString:Var欢迎信息=' ','@var临时用户名','@Var欢迎信息';Set:欢迎信息_1=@Var欢迎信息;" Container="" DataType=""/><Var ID="Var小时部分" Memo="" Title="Var小时部分" Value="9" Container="" DataType=""/><Var ID="Var欢迎信息" Memo="" Title="Var欢迎信息" Value="admin ，上午好！" Container="" DataType=""/><Var ID="db系统配置" Memo="" Title="db系统配置" Value="" Container="" DataType="DataSet"/><Var ID="fun_增加管理员判断" Memo="" Title="fun_增加管理员判断" Value="DB:db用户=Access,'尚嘉2017.mdb','',SQL select * from t0001用户 where 用户名='@TB_临时用户名' and 是否删除='否';GetRecordCount:var检测是否登陆=db用户;Case:var检测是否登陆 == 1 Then MsgBox:var = 该用户名被占用,1,'错误提示' Else RunAction:fun_增加管理员;" Container="" DataType=""/><Var ID="fun_增加管理员" Memo="" Title="fun_增加管理员" Value="Hash:var密码MD5=STRING,MD5,'@TB_临时密码';GetDateTime:Var系统当前时间= HH:mm:ss;DB:db用户=Access,'尚嘉2017.mdb','',SQL insert into t0001用户(ID,是否删除,用户名,密码) values('@Var系统当前时间','否','@TB_临时用户名','@var密码MD5');MsgBox:var = 成功添加账号,1,'操作成功';RunAction:fun刷新用户列表;" Container="" DataType=""/><Var ID="db轮播图" Memo="" Title="db轮播图" Value="" Container="" DataType="DataSet"/><Var ID="当前条目id" Memo="" Title="当前条目id" Value="1" Container="" DataType=""/><Var ID="fun_刷新首页轮播" Memo="" Title="fun_刷新首页轮播" Value="DB:db轮播图=Access,'尚嘉2017.mdb','',SQL SELECT * FROM t0010首页轮播图 WHERE 是否删除='否';BindingDataTo:Report活动列表=db轮播图,轮播图名称;GetFieldValue:预览图.Picture=db轮播图,1,图片地址;" Container="" DataType=""/><Var ID="fun_刷新主题活动" Memo="" Title="fun_刷新主题活动" Value="DB:db轮播图=Access,'尚嘉2017.mdb','',SQL SELECT * FROM t0020主题活动 WHERE 活动分类='@var活动分类' and 是否删除='否';BindingDataTo:Report活动列表=db轮播图,活动分类,活动名称;GetFieldValue:预览图.Picture=db轮播图,1,图片地址;" Container="" DataType=""/><Var ID="图片源文件位置" Memo="" Title="图片源文件位置" Value="E:\泽阳项目\尚嘉中心\软件\版本\尚嘉预览版V09-20170607\Data\主题活动\至尊会1.bmp" Container="" DataType=""/><Var ID="txt文件名" Memo="" Title="txt文件名" Value="至尊会1.bmp" Container="" DataType=""/><Var ID="var图片保存位置" Memo="" Title="var图片保存位置" Value="DataPath\主题活动\至尊会1.bmp" Container="" DataType=""/><Var ID="Var图片数据库地址" Memo="" Title="Var图片数据库地址" Value="主题活动\至尊会1.bmp" Container="" DataType=""/><Var ID="Var当前条目在数据库中的id" Memo="" Title="Var当前条目在数据库中的id" Value="2017-05-12 00:33:14" Container="" DataType=""/><Var ID="fun_增加轮播图" Memo="" Title="fun_增加轮播图" Value="GetDateTime:Var系统当前时间=YYYY-MM-DD HH:mm:ss;--将图片保存到指定位置;FileCopy:'@var图片保存位置'='@图片源文件位置';--将数据插入数据库;DB:db轮播图=Access,尚嘉2017.mdb,,SQL INSERT INTO t0020主题活动 (ID,是否删除,活动分类,活动名称,图片地址,是否有效,生效时间,失效时间) VALUES ('@Var系统当前时间','否','@CB_轮播图类型','@TB_活动名称','@var图片数据库地址','是','','');" Container="" DataType=""/><Var ID="var楼层图片" Memo="" Title="var楼层图片" Value="LayerL1" Container="Layer:Layer设备管理" DataType=""/><Var ID="var设备坐标" Memo="" Title="var设备坐标" Value="202-179" Container="Layer:Layer设备管理" DataType=""/><Var ID="db设备列表" Memo="" Title="db设备列表" Value="" Container="Layer:Layer设备管理" DataType="DataSet"/><Var ID="varID" Memo="" Title="varID" Value="545" Container="Layer:Layer设备管理" DataType=""/><Var ID="var当前楼层设备坐标" Memo="" Title="var当前楼层设备坐标" Value="437-490" Container="Layer:Layer设备管理" DataType=""/><Var ID="[x]" Memo="" Title="[x]" Value="156" Container="" DataType=""/><Var ID="[y]" Memo="" Title="[y]" Value="2" Container="" DataType=""/><Var ID="Index" Memo="" Title="Index" Value="4" Container="Layer:Panel_设备管理" DataType=""/><Var ID="db楼层列表" Memo="" Title="db楼层列表" Value="" Container="Layer:Panel_设备管理" DataType="DataSet"/><Var ID="varLeft" Memo="" Title="varLeft" Value="402.5" Container="Layer:Panel_设备管理" DataType=""/><Var ID="varTop" Memo="" Title="varTop" Value="420" Container="Layer:Panel_设备管理" DataType=""/><Var ID="varCount" Memo="" Title="varCount" Value="2" Container="Layer:Layer导航管理" DataType=""/><Var ID="db店铺列表" Memo="" Title="db店铺列表" Value="" Container="Layer:Layer导航管理" DataType="DataSet"/><Var ID="var当前楼层" Memo="" Title="var当前楼层" Value="L1" Container="Layer:Layer导航管理" DataType=""/><Var ID="var目标楼层" Memo="" Title="var目标楼层" Value="L1" Container="Layer:Layer导航管理" DataType=""/><Var ID="var目标楼层序号" Memo="" Title="var目标楼层序号" Value="3" Container="Layer:Layer导航管理" DataType=""/><Var ID="var出发楼层序号" Memo="" Title="var出发楼层序号" Value="3" Container="Layer:Layer导航管理" DataType=""/><Var ID="var当前楼层序号" Memo="" Title="var当前楼层序号" Value="3" Container="Layer:Layer导航管理" DataType=""/><Var ID="varFinishIndex" Memo="" Title="varFinishIndex" Value="3" Container="Layer:Layer导航管理" DataType=""/><Var ID="varStartIndex" Memo="" Title="varStartIndex" Value="3" Container="Layer:Layer导航管理" DataType=""/><Var ID="fun执行滚动切换楼层指令" Memo="" Title="fun执行滚动切换楼层指令" Value="--判断楼层如果大，就上升，如果小就下降;IF:var电梯方向=@varFinishIndex &gt; @varStartIndex Then 'Add' Else 'Subtract';Case:@varFinishIndex == @varStartIndex Then ExitAction;Calc:varGap=@varFinishIndex - @varStartIndex;Math:varGap='Abs','@varGap';For:1,@varGap=RunAction:Move:LayerL4,LayerL3,LayerL2,LayerL1,LayerLG1,LayerLG2='0-753',@var电梯方向,100;--切换指针到目标楼层;LinkString:var楼层图片='','Layer','@var目标楼层';Set:LayerPin.Container='@var楼层图片';Set:var当前楼层序号='@varFinishIndex ';GetFieldValue:var当前楼层=db楼层列表,序号=@var当前楼层序号,楼层名称;--清除点和线;Clear:@var楼层图片;" Container="Layer:Panel_导航管理" DataType=""/><Var ID="var电梯方向" Memo="" Title="var电梯方向" Value="Subtract" Container="Layer:Panel_导航管理" DataType=""/><Var ID="varGap" Memo="" Title="varGap" Value="1" Container="Layer:Panel_导航管理" DataType=""/><Var ID="i" Memo="" Title="i" Value="2" Container="Layer:Panel_导航管理" DataType=""/><Var ID="[LayerL1_OnMouseUp]" Memo="" Title="[LayerL1_OnMouseUp]" Value="RunAction:fun记录并标注鼠标位置;" Container="Layer:Panel_导航管理" DataType=""/><Var ID="var坐标" Memo="" Title="var坐标" Value="503-462" Container="Layer:Panel_导航管理" DataType=""/><Var ID="fun删除一个热点" Memo="" Title="fun删除一个热点" Value="Delete:'HotPoint@i';" Container="" DataType=""/><Var ID="varNew" Memo="" Title="varNew" Value="HotPoint15" Container="Layer:Panel_导航管理" DataType=""/><Var ID="fun聚合一个坐标" Memo="" Title="fun聚合一个坐标" Value="LinkString:var聚合坐标='/','@var聚合坐标','@List行走路线坐标.List(@i)';--MsgBox:var='@var聚合坐标';" Container="Layer:Panel_导航管理" DataType=""/><Var ID="var聚合坐标" Memo="" Title="var聚合坐标" Value="GO-L3 (5)/215-183/199-205/203-517/362-521" Container="Layer:Panel_导航管理" DataType=""/><Var ID="var铺位编号" Memo="" Title="var铺位编号" Value="SHL03005" Container="Layer:Panel_导航管理" DataType=""/><Var ID="var铺位号" Memo="" Title="var铺位号" Value="L305" Container="Layer:Panel_导航管理" DataType=""/><Var ID="var出发设备编号" Memo="" Title="var出发设备编号" Value="L101" Container="Layer:Panel_导航管理" DataType=""/><Var ID="var品牌中文名" Memo="" Title="var品牌中文名" Value="博柏利童装" Container="Layer:Panel_导航管理" DataType=""/><Var ID="db铺位导航列表" Memo="" Title="db铺位导航列表" Value="" Container="Layer:Panel_导航管理" DataType="DataSet"/><Var ID="[Report目标楼层店铺列表_OnMouseUp]" Memo="" Title="[Report目标楼层店铺列表_OnMouseUp]" Value="HideControl:Report目标楼层店铺列表;" Container="Layer:Panel_导航管理" DataType=""/><Var ID="fun刷新用户列表" Memo="" Title="fun刷新用户列表" Value="DB:db用户=Access,'尚嘉2017.mdb','',SQL select * from t0001用户 where 是否删除='否';BindingDataTo:List用户列表=db用户,用户名;set:当前条目id='1';" Container="" DataType=""/><Var ID="fun修改系统时间" Memo="" Title="fun修改系统时间" Value="DB:db系统配置=Access,'尚嘉2017.mdb','',SQL update t0003系统配置 set 是否删除='是' where 是否删除='否';GetDateTime:Var系统当前时间= HH:mm:ss;DB:db系统配置=Access,'尚嘉2017.mdb','',SQL insert into t0003系统配置(ID,系统待机时间,轮播图间隔,是否删除) values ('@Var系统当前时间','@TB_系统待机时间','@TB_轮播图间隔','否');RunAction:fun刷新当前时间;" Container="" DataType=""/><Var ID="fun刷新当前时间" Memo="" Title="fun刷新当前时间" Value="DB:db系统配置=Access,'尚嘉2017.mdb','',SQL SELECT * FROM t0003系统配置 where 是否删除='否';GetFieldValue:当前系统待机时间=db系统配置,1,系统待机时间;GetFieldValue:当前轮播图间隔=db系统配置,1,轮播图间隔;" Container="" DataType=""/><Var ID="fun_删除首页轮播图" Memo="" Title="fun_删除首页轮播图" Value="GetFieldValue:Var当前条目在数据库中的id=db轮播图,@当前条目id,ID;DB:db轮播图=Access,尚嘉2017.mdb,,SQL update  t0010首页轮播图 set 是否删除='是' WHERE ID='@Var当前条目在数据库中的id';MsgBox:var = 操作成功,0,tip;" Container="" DataType=""/><Var ID="fun_删除非首页轮播图" Memo="" Title="fun_删除非首页轮播图" Value="GetFieldValue:Var当前条目在数据库中的id=db轮播图,@当前条目id,ID;DB:db轮播图=Access,尚嘉2017.mdb,,SQL update  t0020主题活动 set 是否删除='是' WHERE ID='@Var当前条目在数据库中的id';MsgBox:var = 操作成功,0,tip;" Container="" DataType=""/><Var ID="fun_增加首页轮播图" Memo="" Title="fun_增加首页轮播图" Value="GetDateTime:Var系统当前时间=YYYY-MM-DD HH:mm:ss;--将图片保存到指定位置;FileCopy:'@var图片保存位置'='@图片源文件位置';--将数据插入数据库;DB:db轮播图=Access,尚嘉2017.mdb,,SQL INSERT INTO t0010首页轮播图 (ID,是否删除,轮播图名称,图片地址,是否有效,生效日期,失效日期) VALUES ('@Var系统当前时间','否','@TB_活动名称','@var图片数据库地址','是','','');MsgBox:var = 操作成功,0,tip;" Container="" DataType=""/><Var ID="fun_增加非首页轮播图" Memo="" Title="fun_增加非首页轮播图" Value="GetDateTime:Var系统当前时间=YYYY-MM-DD HH:mm:ss;--将图片保存到指定位置;FileCopy:'@var图片保存位置'='@图片源文件位置';--将数据插入数据库;DB:db轮播图=Access,尚嘉2017.mdb,,SQL INSERT INTO t0020主题活动 (ID,是否删除,活动分类,活动名称,图片地址,是否有效,生效时间,失效时间) VALUES ('@Var系统当前时间','否','@CB_轮播图类型','@TB_活动名称','@var图片数据库地址','是','','');MsgBox:var = 操作成功,0,tip;" Container="" DataType=""/><Var ID="var活动分类" Memo="" Title="var活动分类" Value="主题活动" Container="" DataType=""/><Var ID="fun走一步并画线" Memo="" Title="fun走一步并画线" Value="GetPartOfString:varLeft=@List行走路线坐标.List(@i),'-',1;GetPartOfString:varTop=@List行走路线坐标.List(@i),'-',2;--MsgBox:var='@i @varLeft - @varTop';--指令1：GO（切换楼层）;--计算目标楼层;Case:@varLeft=='GO' Then GetPartOfString:var目标楼层='@varTop',' ',FIRST;Case:@varLeft=='GO' Then GetPartOfString:var目标楼层序号='@varTop','(',LAST;Case:@varLeft=='GO' Then GetPartOfString:var目标楼层序号='@var目标楼层序号',')',FIRST;Case:@varLeft=='GO' Then Set:varStartIndex='@var当前楼层序号';Case:@varLeft=='GO' Then Set:varFinishIndex='@var目标楼层序号';--开始切换;Case:@varLeft=='GO' Then RunAction:fun执行滚动切换楼层指令;Case:@varLeft=='GO' Then Set:var目标楼层第一个='是';Case:@varLeft=='GO' Then ExitAction;--指令2：DELAY（延时）;Case:@varLeft=='DELAY' Then Sleep:@varTop;Case:@varLeft=='DELAY' Then ExitAction;--指令3：显示路径标记;LinkString:var楼层图片='','Layer','@var目标楼层';Case:@i == 0 Then Set:varLastLeft='@varLeft';Case:@i == 0 Then Set:varLastTop='@varTop';Case:'@var单步测试' == '是' Then Set:varLastLeft='@varLeft';Case:'@var单步测试' == '是' Then Set:varLastTop='@varTop';Case:'@var目标楼层第一个'&lt;&gt;'是' Then DrawLine:@var楼层图片='@varLastLeft/@varLastTop','@varLeft/@varTop',6697881,8,2,LINE,'40',-400;--DrawLine:@var楼层图片='@varLeft/@varTop','@varLeft/@varTop',26367,10,2,LINE,'20';Set:varLastLeft=@varLeft;Set:varLastTop=@varTop;Set:var目标楼层第一个='否';" Container="" DataType=""/><Var ID="var目标楼层第一个" Memo="" Title="var目标楼层第一个" Value="否" Container="" DataType=""/><Var ID="varLastLeft" Memo="" Title="varLastLeft" Value="503" Container="" DataType=""/><Var ID="varLastTop" Memo="" Title="varLastTop" Value="462" Container="" DataType=""/><Var ID="var店铺坐标选取中" Memo="" Title="var店铺坐标选取中" Value="" Container="" DataType=""/><Var ID="var单步测试" Memo="" Title="var单步测试" Value="否" Container="" DataType=""/><Var ID="var出发层设置状态" Memo="" Title="var出发层设置状态" Value="否" Container="Layer:Layer坐标设置" DataType=""/><Var ID="fun加载出发层轨迹" Memo="" Title="fun加载出发层轨迹" Value="--如果找到行走路线数据，则加载;DB:db设备列表=Access,'尚嘉2017.mdb','',SQL SELECT * FROM t0002设备 WHERE 设备所在楼层名称='@Combo出发楼层';Set:var聚合坐标='';GetFieldValue:var聚合坐标=db设备列表,1,出发层轨迹;Clear:List行走路线坐标;GetPartOfString:List行走路线坐标='@var聚合坐标','/',Binding;" Container="Layer:Layer坐标设置" DataType=""/><Var ID="var出发层轨迹" Memo="" Title="var出发层轨迹" Value="455-477/452-518/202-510/203-181/258-235/DELAY-1000" Container="" DataType=""/><Var ID="var行走轨迹" Memo="" Title="var行走轨迹" Value="236-509/530-507/503-462" Container="" DataType=""/><Var ID="fun记录并标注鼠标位置" Memo="" Title="fun记录并标注鼠标位置" Value="--将指针图片移动到鼠标点击时的坐标;Set:var坐标='@[x]-@[y]';--Add:List行走路线坐标=S,'@[x]-@[y]';Set:txt当前坐标.Text='@[x]-@[y]';Calc:LayerPin.Left=@[x] - (@LayerPin.Width / 2);Calc:LayerPin.Top=@[y] - @LayerPin.Height;" Container="Layer:Panel_导航管理" DataType=""/><Var ID="fun查询目标楼层店铺轨迹" Memo="" Title="fun查询目标楼层店铺轨迹" Value="--显示店铺数据;DB:db店铺列表=Access,'尚嘉2017.mdb','',SELECT t3001铺位及品牌.铺位编号,t3001铺位及品牌.铺位号,t3001铺位及品牌.品牌中文名,t3002铺位导航.行走轨迹 FROM t3001铺位及品牌 left outer join t3002铺位导航 on t3001铺位及品牌.铺位编号 = t3002铺位导航.目标铺位编号 WHERE 楼层='@Combo终点楼层'  Order by 铺位号;MsgBox:var='开始查询咯';BindingDataTo:Report目标楼层店铺列表=db店铺列表;--隐藏【铺位编号】列;ReportSet:Report目标楼层店铺列表=ColumnVisible,0,False;" Container="" DataType=""/></Vars><Groups/></Data></Project></Solution>
